# piliang.py 更新说明

我们对 `piliang.py` 脚本进行了以下主要修改和功能增强：

1. FFmpeg 集成：
   - 自动检测并添加 FFmpeg 到系统 PATH
   - 验证 FFmpeg 是否可用，并提供相应的错误处理

2. 文件处理增强：
   - 支持处理单个 txt 文件或包含多个 txt 文件的文件夹
   - 复制相关的音频文件（mp3 或 wav，不区分大小写）和 SRT 文件

3. 视频处理流程优化：
   - 为每个 txt 文件创建独立的输出文件夹
   - 搜索视频并复制到对应的输出文件夹
   - 处理完每个 txt 文件后立即执行视频合并

4. 视频合并功能：
   - 使用 FFmpeg 根据 SRT 文件内容合并视频片段
   - 保持原始视频的时间戳
   - 将音频文件添加到合并后的视频中
   - 合并后的视频时长比音频多 300 毫秒

5. 清理功能：
   - 合并成功后自动删除原始视频文件
   - 删除临时生成的元数据文件和文件夹

6. 错误处理和日志记录：
   - 详细的日志记录，包括每个步骤的操作结果
   - 对 FFmpeg 命令执行失败进行错误捕获和记录
   - 如果视频合并失败，保留原始视频文件

7. 命令行参数：
   - 支持指定输入路径（单个文件或文件夹）
   - 支持指定输出文件夹
   - 可以设置每个关键词保存的视频数量（top_n 参数）

使用方法：
显示帮助信息并退出
- `-i INPUT`, `--input INPUT`: 指定输入路径，可以是单个txt文件或包含多个txt文件的文件夹
- `-o OUTPUT`, `--output OUTPUT`: 指定输出文件夹路径
- `-n TOP_N`, `--top_n TOP_N`: 设置每个关键词保存的视频数量（默认为5）

示例：
1. 处理单个文件：
   ```
   python piliang.py -i path/to/your/file.txt -o path/to/output/folder -n 3
   ```

2. 处理文件夹：
   ```
   python piliang.py -i path/to/your/folder -o path/to/output/folder -n 7
   ```

3. 使用默认参数：
   ```
   python piliang.py
   ```
   这将使用当前目录作为输入和输出路径，并保存每个关键词的前5个视频。

注意：确保您的系统中已安装 FFmpeg，脚本会自动尝试将其添加到系统 PATH 中。如果遇到 FFmpeg 相关的问题，请检查您的 FFmpeg 安装是否正确。